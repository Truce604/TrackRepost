
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrackRepost - Campaigns</title>
    <link rel="stylesheet" href="styles.css"> <!-- Link to your CSS -->
    
    <!-- ‚úÖ Load Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <!-- ‚úÖ Load SoundCloud SDK -->
    <script src="https://connect.soundcloud.com/sdk.js"></script>

    <!-- ‚úÖ Load Firebase Configuration -->
    <script src="firebaseConfig.js"></script>

    <!-- ‚úÖ Load Authentication & Script AFTER Firebase -->
    <script src="auth.js" defer></script>
</head>

<body>
    <header>
        <h1>üî• Active Campaigns</h1>
        <p>Explore the campaigns and repost to earn credits!</p>
    </header>

    <!-- ‚úÖ Campaigns Container -->
    <div id="campaignsContainer">
        <p>‚è≥ Loading campaigns...</p>
    </div>

    <footer>
        <p>¬© 2025 TrackRepost. All Rights Reserved.</p>
    </footer>

    <script>
        // ‚úÖ FUNCTION: Load and Display Campaigns
        window.loadCampaigns = function () {
            const campaignsDiv = document.getElementById("campaignsContainer");

            firebase.firestore().collection("campaigns").orderBy("timestamp", "desc").onSnapshot(snapshot => {
                campaignsDiv.innerHTML = "";  // Clear before adding new

                if (snapshot.empty) {
                    campaignsDiv.innerHTML = "<p>No active campaigns available.</p>";
                } else {
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        const campaignId = doc.id;
                        const trackUrl = data.track;

                        campaignsDiv.innerHTML += `
                            <div class="campaign">
                                <h3>üî• Track Promotion</h3>
                                <iframe width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay" 
                                    src="https://w.soundcloud.com/player/?url=${encodeURIComponent(trackUrl)}">
                                </iframe>
                                <button onclick="repostTrack('${campaignId}', '${data.owner}', '${trackUrl}')">
                                    Repost & Earn Credits
                                </button>
                            </div>
                        `;
                    });
                }
            });
        };

        // ‚úÖ AUTOLOAD CAMPAIGNS
        document.addEventListener("DOMContentLoaded", loadCampaigns);
    </script>
</body>
</html>
